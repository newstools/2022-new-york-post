DALLAS — Airlines that have stumbled badly over the last two holidays face their biggest test yet of whether they can handle big crowds when July Fourth travelers mob the nation’s airports this weekend. Problems were popping up well before the weekend, with some disruptions caused by thunderstorms that slowed air traffic. American Airlines canceled 8% of its flights on Tuesday and Wednesday, and United Airlines scrubbed 4% of its schedule both days, according to FlightAware. Holiday revelers planning to drive face their own set of challenges, including high gasoline prices. The nationwide average has eased since hitting a record $5.02 in mid-June to $4.86 a gallon on Thursday, according to AAA, which expects prices to continue to ease because of rising gasoline inventories. Americans are driving a bit less. Gas demand last week was down about 3% from the same week last June, according to government figures. In a Quinnipiac University poll in June, 40% of those surveyed said gas prices have caused them to change their summer vacation plans. Air travel in the U.S. is almost back to pre-pandemic levels. Since last Saturday, an average of nearly 2.3 million people a day have gone through airport checkpoints — down just 8% from the same days in 2019. If that trend continues through weekend, records will be set for flying in the pandemic era. Airlines may not have enough planes and flights to carry all of them, especially if there are cancellations due to weather, crew shortages or any other reason. “Airlines are learning the hard way that there is a severe price for over-optimism,” said Joseph Schwieterman, a transportation expert at DePaul University. “They are on the edge of a cliff this holiday.” Schwieterman calculates that airlines have little cushion between the number of travelers expected to fly this weekend and the flights they plan to operate — if all goes well. Any disruptions could cause chaos because planes are booked full — there will be no empty seats on later flights to accommodate stranded travelers. Airlines have been caught short-staffed as they try to hire thousands of workers, including pilots, to replace those who they encouraged to quit when the pandemic caused air travel to plummet. Many of them, including Delta, Southwest and JetBlue, have trimmed summer schedules to reduce stress on their operations. They are using larger planes on average to carry more passengers with the same number of pilots. Those steps haven’t been enough so far this summer. Delta Air Lines took the unusual step this week of warning travelers that there could be problems over the holiday weekend. The Atlanta-based airline said it expects the biggest crowds since 2019, and this will create “some operational challenges.” It is allowing passengers booked on flights between Friday and the Monday holiday to change their schedule at no cost, even if the new flight comes with a higher fare. “Delta people are working around the clock to rebuild Delta’s operation while making it as resilient as possible to minimize the ripple effect of disruptions,” the airline said. Delta had by far the most canceled flights of any U.S. airline over the Memorial Day holiday stretch, when U.S. carriers scrubbed nearly 2,800 flights, and again last weekend, when it canceled 7% of its flights, according to FlightAware. The airlines are increasingly trying to blame delays on understaffing at the Federal Aviation Administration, which manages the nation’s airspace and hires air traffic controllers. “This year versus previous years, the biggest issue has been air traffic control,” said Barry Biffle, the CEO of Frontier Airlines. “We’ve made a lot of steps to avoid the Jacksonville center in our scheduling, and we have reduced some flying to accommodate that.” The FAA has a major facility in Jacksonville, Florida, that handles many flights up and down the East Coast. After a meeting with airline representatives in May, the FAA promised to increase staffing at the center. Delta CEO Ed Bastian similarly blamed the FAA during an online meeting with employees Wednesday, trade publication Airline Weekly reported. Delta declined to comment. Transportation Secretary Pete Buttigieg pushed back earlier this week when the head of the trade group Airlines for America blamed the FAA for delays. “The majority of cancellations and the majority of delays have nothing to do with air traffic control staffing,” Buttigieg told “NBC Nightly News.” Helane Becker, an airline analyst for investment firm Cowen, said there are many reasons for the disruptions including weather, FAA ground stops that last too long, and flight crews hitting their legal limit of working hours in a day. The airlines “seem to fail” when it comes down to daily operations, and the FAA didn’t train enough new air traffic controllers — a process that can take up to four years — to offset retirements. “We expect it to be a long, tiresome summer for everyone,” she said. The loudest lawmakers mostly seem to blame the airlines for leaving passengers stranded. Some point out that Congress gave the industry $54 billion in pandemic relief. Sen. Bernie Sanders, I-Vt., urged Buttigieg to require airlines to issue refunds for delays longer than an hour and fine them for delays longer than two hours and for scheduling flights that they can’t staff. Sanders accused airlines of stranding passengers while charging “outrageously high prices.” Buttigieg has threatened fines if airlines don’t fix their operations. Sens. Edward Markey, D-Mass., and Richard Blumenthal, D-Conn., asked 10 airline CEOs this week to “take immediate action” to reduce travel disruptions. The senators demanded information about how each airline decides which flights to cancel and the number of consumer refunds requested and granted.